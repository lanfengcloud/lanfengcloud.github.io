<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>大型前端项目的痛点和优化方案 | 花椒和邻居&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/87452.png">
    <meta name="description" content="web前端技术博客,花椒和邻居sBlog,持续专注web前端学习与总结。Cesium,markdown,JavaScript,js,ES6,TypeScript,vue,React,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.11b57309.css" as="style"><link rel="preload" href="/assets/js/app.0f535a60.js" as="script"><link rel="preload" href="/assets/js/2.05e52b40.js" as="script"><link rel="preload" href="/assets/js/32.1f1e2cf4.js" as="script"><link rel="prefetch" href="/assets/js/10.eb751d19.js"><link rel="prefetch" href="/assets/js/11.1ae5821a.js"><link rel="prefetch" href="/assets/js/12.855592a6.js"><link rel="prefetch" href="/assets/js/13.c3fe43b7.js"><link rel="prefetch" href="/assets/js/14.65830ff2.js"><link rel="prefetch" href="/assets/js/15.eeb5c16d.js"><link rel="prefetch" href="/assets/js/16.6963c432.js"><link rel="prefetch" href="/assets/js/17.cdb396c1.js"><link rel="prefetch" href="/assets/js/18.123af83c.js"><link rel="prefetch" href="/assets/js/19.71816da4.js"><link rel="prefetch" href="/assets/js/20.2e9ac2dd.js"><link rel="prefetch" href="/assets/js/21.3fd5a05c.js"><link rel="prefetch" href="/assets/js/22.3c1490e9.js"><link rel="prefetch" href="/assets/js/23.65039aac.js"><link rel="prefetch" href="/assets/js/24.ffa06743.js"><link rel="prefetch" href="/assets/js/25.62a8fe08.js"><link rel="prefetch" href="/assets/js/26.104abc22.js"><link rel="prefetch" href="/assets/js/27.6a97bd92.js"><link rel="prefetch" href="/assets/js/28.b97a22f8.js"><link rel="prefetch" href="/assets/js/29.3769b298.js"><link rel="prefetch" href="/assets/js/3.50edd948.js"><link rel="prefetch" href="/assets/js/30.fc66c44c.js"><link rel="prefetch" href="/assets/js/31.521852b4.js"><link rel="prefetch" href="/assets/js/33.eddfd55c.js"><link rel="prefetch" href="/assets/js/34.6fd0425a.js"><link rel="prefetch" href="/assets/js/35.65e5c233.js"><link rel="prefetch" href="/assets/js/36.b1a6dfb7.js"><link rel="prefetch" href="/assets/js/37.c838845b.js"><link rel="prefetch" href="/assets/js/38.e4656ba7.js"><link rel="prefetch" href="/assets/js/39.26be2f63.js"><link rel="prefetch" href="/assets/js/4.363761dc.js"><link rel="prefetch" href="/assets/js/40.761b5acd.js"><link rel="prefetch" href="/assets/js/41.50eca299.js"><link rel="prefetch" href="/assets/js/42.bccb1a04.js"><link rel="prefetch" href="/assets/js/43.21a434df.js"><link rel="prefetch" href="/assets/js/44.6cf97a3c.js"><link rel="prefetch" href="/assets/js/45.dc33a976.js"><link rel="prefetch" href="/assets/js/46.b9ea595c.js"><link rel="prefetch" href="/assets/js/47.3394a680.js"><link rel="prefetch" href="/assets/js/48.54230b8f.js"><link rel="prefetch" href="/assets/js/49.16b6bb88.js"><link rel="prefetch" href="/assets/js/5.74f4d701.js"><link rel="prefetch" href="/assets/js/50.fff1f0f6.js"><link rel="prefetch" href="/assets/js/51.2a6b3df9.js"><link rel="prefetch" href="/assets/js/52.cd4f0cb3.js"><link rel="prefetch" href="/assets/js/53.9583e5fb.js"><link rel="prefetch" href="/assets/js/54.88f9013b.js"><link rel="prefetch" href="/assets/js/55.2b3fcbbb.js"><link rel="prefetch" href="/assets/js/56.95fec35a.js"><link rel="prefetch" href="/assets/js/57.888fbb14.js"><link rel="prefetch" href="/assets/js/58.8ae049ae.js"><link rel="prefetch" href="/assets/js/59.a9dfa523.js"><link rel="prefetch" href="/assets/js/6.c8ab2f07.js"><link rel="prefetch" href="/assets/js/60.9c826ab2.js"><link rel="prefetch" href="/assets/js/61.90cc6b82.js"><link rel="prefetch" href="/assets/js/62.a84fbb1c.js"><link rel="prefetch" href="/assets/js/63.9fcc1483.js"><link rel="prefetch" href="/assets/js/64.43b7fc9d.js"><link rel="prefetch" href="/assets/js/65.a2eeed6b.js"><link rel="prefetch" href="/assets/js/66.863994ac.js"><link rel="prefetch" href="/assets/js/67.b75f9f5a.js"><link rel="prefetch" href="/assets/js/68.30642ba5.js"><link rel="prefetch" href="/assets/js/69.ef0a2386.js"><link rel="prefetch" href="/assets/js/7.6ebe873b.js"><link rel="prefetch" href="/assets/js/70.abcef950.js"><link rel="prefetch" href="/assets/js/71.564075b4.js"><link rel="prefetch" href="/assets/js/72.69af9f7a.js"><link rel="prefetch" href="/assets/js/73.d9aab1f1.js"><link rel="prefetch" href="/assets/js/74.2e863d32.js"><link rel="prefetch" href="/assets/js/75.2fecba76.js"><link rel="prefetch" href="/assets/js/76.77327a24.js"><link rel="prefetch" href="/assets/js/8.a849c732.js"><link rel="prefetch" href="/assets/js/9.8b46df0d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.11b57309.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="花椒和邻居's Blog" class="logo"> <span class="site-name can-hide">花椒和邻居's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><a href="/open/" class="nav-link">开源</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/e58ecf/" class="nav-link">Java程序员</a></li></ul></div></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/f2e63f.html" class="nav-link">随笔</a></div> <a href="https://github.com/rwerplus/rwerplus.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/ava.2gamq0p5pj8k.webp"> <div class="blogger-info"><h3>花椒和邻居</h3> <span>工作了三年半的前端实习生</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><a href="/open/" class="nav-link">开源</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/e58ecf/" class="nav-link">Java程序员</a></li></ul></div></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/f2e63f.html" class="nav-link">随笔</a></div> <a href="https://github.com/rwerplus/rwerplus.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端开发笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/86005a/" class="sidebar-link">重识 HTML，掌握页面基本结构和加载过程</a></li><li><a href="/pages/21c2f2/" class="sidebar-link">CSS：页面布局的基本规则和方式</a></li><li><a href="/pages/884d6e/" class="sidebar-link">JavaScript 如何实现继承？</a></li><li><a href="/pages/13ef6c/" class="sidebar-link">JavaScript 引擎如何执行 JavaScript 代码？</a></li><li><a href="/pages/c3f2e0/" class="sidebar-link">单线程的 JavaScript 如何管理任务？</a></li><li><a href="/pages/6fddea/" class="sidebar-link">一个网络请求是怎么进行的？</a></li><li><a href="/pages/595abe/" class="sidebar-link">HTTP 协议和前端开发有什么关系？</a></li><li><a href="/pages/53ab0a/" class="sidebar-link">深入剖析浏览器中页面的渲染过程</a></li><li><a href="/pages/b206ba/" class="sidebar-link">改善编程思维：从事件驱动到数据驱动</a></li><li><a href="/pages/ea57d2/" class="sidebar-link">掌握前端框架模板引擎的实现原理</a></li><li><a href="/pages/49a69e/" class="sidebar-link">为什么小程序特立独行</a></li><li><a href="/pages/f761ed/" class="sidebar-link">单页应用与前端路由库设计原理</a></li><li><a href="/pages/596343/" class="sidebar-link">代码构建与 Webpack 必备技能</a></li><li><a href="/pages/996215/" class="sidebar-link">提升编程体验：组件化与模块化设计</a></li><li><a href="/pages/7d3a8a/" class="sidebar-link">AngularReactVue 三大前端框架的设计特色</a></li><li><a href="/pages/ddbbb3/" class="sidebar-link">如何设计合适的状态管理方案</a></li><li><a href="/pages/9c6643/" class="sidebar-link">如何搭建前端监控体系为业务排忧解难</a></li><li><a href="/pages/aeb6b9/" class="sidebar-link">如何进行性能分析的自动化实现</a></li><li><a href="/pages/55cc33/" class="sidebar-link">前端性能优化与解决方案</a></li><li><a href="/pages/ee7a1a/" class="sidebar-link">如何进行技术方案调研与设计</a></li><li><a href="/pages/b1d475/" class="sidebar-link">如何设计一个前端项目</a></li><li><a href="/pages/8a03a9/" class="sidebar-link">通过前端工程化提升团队开发效率</a></li><li><a href="/pages/e991d8/" aria-current="page" class="active sidebar-link">大型前端项目的痛点和优化方案</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/75d6fd/" class="sidebar-link">如何通过前期准备和后期复盘让项目稳定上线</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>3D地图相关</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-6"><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/web/#前端" data-v-06225672>前端</a></li><li data-v-06225672><a href="/web/#前端开发笔记" data-v-06225672>前端开发笔记</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/rwerplus" target="_blank" title="作者" class="beLink" data-v-06225672>花椒和邻居</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-04-23</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">大型前端项目的痛点和优化方案<!----></h1>  <div class="theme-vdoing-content content__default"><p data-nodeid="3">说到大型前端项目，很多人都会感到疑惑，怎样的项目算是大型前端项目呢？这的确没有一个定级，在这里我们可以粗略地进行定义：当项目的前端开发人员达到 10 人以上、模块数量达到 30 以上、代码量在 30W 行以上的项目，在本课程中可认为是大型前端项目。</p> <p data-nodeid="4">在前端业务领域中，除了大型开源项目（热门框架、VsCode、Atom 等）以外，协同编辑类应用（比如在线文档）、复杂交互类应用（比如大型游戏）等，都可以称得上是大型前端项目。不管是不是大型项目，对于如何进行架构设计、如何快速搭建项目、如何通过工程化来提升开发效率，这些都在前面几讲有介绍。</p> <p data-nodeid="5">今天我们主要围绕着大型前端项目中的痛点进行介绍，比如：</p> <ol data-nodeid="6"><li data-nodeid="7"><p data-nodeid="8">各个模块间耦合严重，功能开发、技术优化、重构工作等均难以开展；</p></li> <li data-nodeid="9"><p data-nodeid="10">项目规模太大，每个人只了解其中一部分，需要改动到不熟悉的模块时常常出问题；</p></li> <li data-nodeid="11"><p data-nodeid="12">项目代码量大，不管是编译、构建，还是浏览器加载，耗时都较多、性能也较差；</p></li> <li data-nodeid="13"><p data-nodeid="14">项目交互逻辑复杂，问题定位、Bug 修复等过程效率很低，需要耗费不少精力。</p></li></ol> <p data-nodeid="15">首先我们来看看模块耦合的问题。</p> <h3 data-nodeid="1258">问题 1：模块耦合严重</h3> <p data-nodeid="17">不同的模块需要进行分工和配合，因此相互之间必然会产生耦合。在大型项目中，由于模块数量很多，如果没有进行合适的管理和约束，可能会导致以下情况：</p> <ol data-nodeid="18"><li data-nodeid="19"><p data-nodeid="20">模块职责和边界定义不清晰，导致模糊的工作可能存在多个模块内；</p></li> <li data-nodeid="21"><p data-nodeid="22">各个模块没有统一管理，导致模块在状态变更时需要手动通知相关模块；</p></li> <li data-nodeid="23"><p data-nodeid="24">模块间的通信方式设计不合理，导致全局事件满天飞、A 模块内直接调用 B 模块等问题，隐藏的引用和事件可能导致内存泄漏。</p></li></ol> <p data-nodeid="25">下面我们来看一个例子。</p> <p data-nodeid="26">小明接到一个渲染层的技术需求，需要在 DOM 渲染的基础上支持 Canvas 渲染，从而提升页面渲染和加载性能。小明认为，渲染层只需要从数据层获取数据，然后根据需要进行 DOM 渲染和 Canvas 渲染就可以了。也就是说，他只需要开发一个 Loader 装载器，并分别实现 DOMLoader 和 CanvasLoader，就可以完成这次的改造。</p> <p data-nodeid="27">当小明开始研究原有的 DOM 加载代码，试图从中拆解出通用 Loader 的逻辑时，他突然发现渲染层并不只是使用到数据层的数据，还有很多来自网络层的事件、并从中响应数据进行渲染。除此之外，渲染层中还存在用户操作（<code data-backticks="1" data-nodeid="158">click</code>/<code data-backticks="1" data-nodeid="160">tap</code>/<code data-backticks="1" data-nodeid="162">touchmove</code>等事件）的逻辑，甚至这些操作还会在渲染层里与数据层、网络层进行逻辑处理。</p> <p data-nodeid="28">考虑到这些逻辑已经存在 2 年多了，当时开发这些功能的小伙伴都不在了，小明对此不熟悉也不敢动，最后只能用兼容的方式（比如<code data-backticks="1" data-nodeid="165">if/else</code>）来实现 Canvas 渲染。小明这样的改造方式，虽然实现了需求，最终却给项目添加了新的技术债务。</p> <p data-nodeid="29">小明遇到的问题，正是因为各个模块间的耦合过于严重、短时间内无法解耦导致的。那么，我们要怎么避免出现模块耦合过多的情况呢？</p> <ol data-nodeid="30"><li data-nodeid="31"><p data-nodeid="32">项目规模调整后，对现有架构设计进行分析，如果不再合适则需要进行及时调整和优化。</p></li> <li data-nodeid="33"><p data-nodeid="34">使用模块解耦的技术方案，将各个模块统一交由框架处理。</p></li> <li data-nodeid="35"><p data-nodeid="36">梳理各个模块的职责，明确每个模块负责的工作和提供的功能，确定各个模块间的边界和调用方式。</p></li></ol> <p data-nodeid="37">在第 14 讲中我已经详细介绍过如何设计模块、使用依赖倒置进行依赖解耦，第 19 讲中也提到如何使用事件监听来管理模块间的通信和状态。在 VsCode 中，我们也可以看到使用依赖注入框架和标准化的<code data-backticks="1" data-nodeid="172">Event/Emitter</code>事件监听的方式，来对各个模块进行解耦。</p> <ul data-nodeid="38"><li data-nodeid="39"><p data-nodeid="40">各个模块的生命周期（初始化、销毁）统一由框架进行管理：通过提供通用类<code data-backticks="1" data-nodeid="175">Disposable</code>，统一管理相关资源的注册和销毁。</p></li> <li data-nodeid="41"><p data-nodeid="42">模块间不直接引入和调用，而是通过声明依赖的方式，从框架中获取相应的服务并使用。</p></li> <li data-nodeid="43"><p data-nodeid="44">不直接使用全局事件进行通信，而是通过订阅具体服务的方式来处理：通过使用同样的方式<code data-backticks="1" data-nodeid="179">this._register()</code>注册事件和订阅事件，将事件相关资源的处理统一挂载到<code data-backticks="1" data-nodeid="181">dispose()</code>方法中。</p></li></ul> <p data-nodeid="45">使用依赖注入框架的好处在于，各个模块之间不会再有直接联系。模块以服务的方式进行注册，通过声明依赖的方式来获取需要使用的服务，框架会对模块间依赖关系进行分析，判断某个服务是否需要初始化和销毁，从而避免了不必要的服务被加载。</p> <p data-nodeid="46">在对模块进行了解耦之后，每个模块都可以专注于自身的功能开发、技术优化，甚至可以在保持对外接口不变的情况下，进行模块重构。</p> <h3 data-nodeid="1758">问题 2：项目复杂熟悉成本过高</h3> <p data-nodeid="48">当一个项目中存在 30 个以上的模块的同时，项目还在不断地进行迭代和优化。在这样的情况下，基本上没有一个人能熟悉所有模块的所有细节，这会带来一些问题：</p> <ul data-nodeid="49"><li data-nodeid="50"><p data-nodeid="51">对于新需求、新功能，开发无法完整地评估技术方案是否可以实现、会不会带来新的问题；</p></li> <li data-nodeid="52"><p data-nodeid="53">需求开发时需要改动不熟悉的代码，无法评估是否存在风险；</p></li> <li data-nodeid="54"><p data-nodeid="55">架构级别的优化工作，难以确定是否可以真正落地；</p></li> <li data-nodeid="56"><p data-nodeid="57">一些模块遗留的历史债务，由于工作进行过多次交接，相关逻辑已无人熟悉，无法进行处理。</p></li></ul> <p data-nodeid="58">导致这些问题的根本原因有两个：</p> <ul data-nodeid="59"><li data-nodeid="60"><p data-nodeid="61">开发者无法专注于某个模块开发；</p></li> <li data-nodeid="62"><p data-nodeid="63">同一个模块可能被多个人调整和变更。</p></li></ul> <p data-nodeid="64">对于这种情况，可以使用模块负责人的机制来对模块进行所有权分配，进行管理和维护。</p> <ol data-nodeid="65"><li data-nodeid="66"><p data-nodeid="67">每个开发者都认领（或分配）一个或多个模块，并要求完全熟悉和掌握模块的细节，且维护文档进行说明。</p></li> <li data-nodeid="68"><p data-nodeid="69">对于需求开发、Bug 修复、技术优化过程中涉及非自身的模块，需要找到对应模块的负责人进行风险评估和代码 Review。</p></li> <li data-nodeid="70"><p data-nodeid="71">模块的负责人负责自身模块的技术优化方案，包括性能优化、自动化测试覆盖、代码规范调整等工作。</p></li> <li data-nodeid="72"><p data-nodeid="73">对于较核心/复杂的模块，可由多个负责人共同维护，协商技术细节。</p></li></ol> <p data-nodeid="74">通过模块负责人机制，每个模块都有了对应的开发进行维护和优化，开发者也可以专注于自身的某些模块进行功能开发。在人员离职和工作内容交接的时候，也可以通过文档+负责人权限的方式进行模块交接。</p> <h3 data-nodeid="2258">问题 3：项目代码量过大</h3> <p data-nodeid="76">对于代码量高达 30W 行以上的项目，如果不做任何优化直接全量跑在浏览器中，不管是加载耗时增加导致用户等待时间过久，还是内存占用过高导致用户交互卡顿，都会给用户带来不好的体验。</p> <p data-nodeid="77">性能优化的解决方案我们在第 22 讲中也有介绍，对于代码量、文件过多这样的性能优化，无非就两个字。</p> <ul data-nodeid="78"><li data-nodeid="79"><p data-nodeid="80">拆：拆模块、拆公共库、拆组件库；</p></li> <li data-nodeid="81"><p data-nodeid="82">分：分流程、分步骤。</p></li></ul> <p data-nodeid="83">比如你可以这么做。</p> <ol data-nodeid="84"><li data-nodeid="85"><p data-nodeid="86">代码按需引入，移除不必要的代码（比如使用 Tree-shaking）。</p></li> <li data-nodeid="87"><p data-nodeid="88">异步加载模块，根据业务需要将模块拆分成多个步骤加载（比如优化依赖注入框架对模块分批初始化）。</p></li> <li data-nodeid="89"><p data-nodeid="90">加载流程优化，分析并对首屏需要的模块做减法。</p></li> <li data-nodeid="91"><p data-nodeid="92">差异化服务，对于不同场景只加载所需要的模块内容（比如读写分离）。</p></li> <li data-nodeid="93"><p data-nodeid="94">代码复用，对重复逻辑进行组件和公共库的抽象和封装。</p></li></ol> <p data-nodeid="95">对于项目代码量过大，代码开发过程中同样存在糟糕的体验：由于代码量过大，开发的本地构建、编译都变得很慢，甚至去打水+上厕所回来之后，代码还没编译完。</p> <p data-nodeid="96">从维护角度来看，一个项目的代码量过大，对开发、编译、构建、部署、发布流程都会同样带来不少的压力。因此除了浏览器加载过程中的代码拆分，对项目代码也可以进行拆分，一般来说有两种方式。</p> <table data-nodeid="2759"><thead data-nodeid="2760"><tr data-nodeid="2761"><th data-nodeid="2763">包管理模式</th> <th data-nodeid="2764">说明</th> <th data-nodeid="2765">优点</th> <th data-nodeid="2766">缺点</th></tr></thead> <tbody data-nodeid="2771"><tr data-nodeid="2772"><td data-nodeid="2773">multirepo</td> <td data-nodeid="2774">多仓库模块管理，通过工作流从各个仓库拉取代码并进行编译、打包</td> <td data-nodeid="2775">模块可根据需要灵活选择各自的编译、构建工具<br>每个仓库的代码量较小，方便维护</td> <td data-nodeid="2776">项目代码分散在各个仓库，问题定位困难<br>模块变动后，需要更新相关仓库的依赖配置</td></tr> <tr data-nodeid="2777"><td data-nodeid="2778">monorepo</td> <td data-nodeid="2779">单仓库模块管理，可使用 lerna 进行包管理</td> <td data-nodeid="2780">项目代码可集中进行管理，使用统一的构建工具<br>模块间调试方便、问题定位和修复相对容易</td> <td data-nodeid="2781">仓库体积大，对构建工具要求较高<br>对项目文件结构和管理、代码可测试和维护性要求较高<br>为了保证代码质量，对版本控制和 Git 工作流要求更高</td></tr></tbody></table> <p data-nodeid="123">两种包管理模式各有优劣，一般来说一个项目只会采用其中一种，但也可以根据具体需要进行调整，比如统一的 UI 组件库进行分仓库管理、核心业务逻辑在主仓库内进行拆包（像渲染层/数据层/网络层拆分模块）管理。</p> <h3 data-nodeid="3298">问题 4：问题定位效率低</h3> <p data-nodeid="125">在对模块进行拆分和解耦、使用了模块负责人机制、进行包拆分管理之后，虽然开发同学可以更加专注于自身负责模块的开发和维护，但有些时候依然无法避免接触其他模块。</p> <p data-nodeid="126">对于这样大型的项目，维护过程（熟悉代码、定位问题、性能优化等）由于代码量太多、各个函数的调用链路太长，以及函数执行情况黑盒、函数调用链不清晰、函数耗时不清楚等问题，导致问题定位异常困难。要是遇到代码稍微复杂点，事件比较多、函数调用也特别多的，即使使用断点调试也能看到眼花，蒸汽眼罩都得多买一些。</p> <p data-nodeid="127">对于这些问题，可以将问题定位过程进行自动化实现，比如：</p> <ol data-nodeid="128"><li data-nodeid="129"><p data-nodeid="130">模块负责人对自身模块执行的关键点进行标记，在开发+调试模式下，其他开发可通过开启断点的方式来直接定位问题。</p></li> <li data-nodeid="131"><p data-nodeid="132">通过使用调用堆栈记录各个关键模块和函数的调用顺序、调用关系、入参出参是否正常，模块负责人提供过往数据的参考和分析建议，其他开发可直接根据指引进行分析。</p></li></ol> <p data-nodeid="133">这个过程，其实是将模块负责人的知识通过工具的方式授予其他开发，大家可以快速找到某个模块经常出问题的地方、模块执行的关键点，根据建议和提示进行问题定位，可极大地提升问题定位的效率。</p> <p data-nodeid="134">除了问题定位以外，各个模块和函数的调用关系、调用耗时也可以作为系统功能和性能是否有异常的参考。因此，我们还可以通过将调用堆栈收集过程自动化、接入流水线，在每次发布前合入代码时执行相关的任务，对比以往的数据进行分析，生成系统性能和功能的风险报告，提前在发布前发现风险。</p> <h3 data-nodeid="3794" class="te-preview-highlight">小结</h3> <p data-nodeid="136">今天给大家介绍了大型前端项目中的一些痛点，概括起来就是：大型项目中代码量过大、模块耦合严重，开发对项目的熟悉成本骤增，导致功能开发、技术优化的风险上升，以及开发维护、问题定位的效率下降。</p> <p data-nodeid="137">通过模块解耦和拆分、使用模块负责人机制、知识传承工具化等方式可以优化上述问题，核心思想是<strong data-nodeid="251">代码职责的拆分+开发职责的拆分</strong>。这样，每个模块可以专注于自身的功能实现，每个开发也可以专注于所负责模块的开发和维护。</p> <p data-nodeid="138">当然，每个解决方案都有各自的利弊，你觉得这样的解决方案的问题和风险点在哪呢？欢迎在留言区进行讨论。</p> <p data-nodeid="139">在我们的日常工作中，通常也会局限于某块功能的实现和某个领域的开发。如果这些内容并没有足够的深度可以挖掘，对个人的成长发展也可能会有限制。在这种情况下，我们可以主动去了解和学习其他领域的知识，也可以主动承担起更多的工作内容。</p> <hr> <h3 id="精选评论"><a href="#精选评论" class="header-anchor">#</a> 精选评论</h3> <h5 id="童"><a href="#童" class="header-anchor">#</a> **童：</h5> <blockquote><p>以前一直用的是multirepo。最近想写个cli，确实想用现在很流行的monorepo项目管理方式，可能会再加lerna。没想到看到被删这篇文章也有提及~&quot;考虑到这些逻辑已经存在 2 年多了，当时开发这些功能的小伙伴都不在了&quot;，都不在了。。好惨</p></blockquote> <h5 id="航"><a href="#航" class="header-anchor">#</a> **航：</h5> <blockquote><p>对于多人协作开发的大型项目，难以避免就会有模块间的循环引用问题，请教一下这个问题目前有没有好的解决方案，除了把逻辑全包到一个方法里让它延迟执行以外</p></blockquote></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/rwerplus/rwerplus.github.io/edit/master/docs/01.前端/01.前端开发笔记/25.大型前端项目的痛点和优化方案.md" target="_blank" rel="noopener noreferrer">去GitHub编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/04/23, 06:56:29</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/8a03a9/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">通过前端工程化提升团队开发效率</div></a> <a href="/pages/75d6fd/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">如何通过前期准备和后期复盘让项目稳定上线</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/8a03a9/" class="prev">通过前端工程化提升团队开发效率</a></span> <span class="next"><a href="/pages/75d6fd/">如何通过前期准备和后期复盘让项目稳定上线</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/49a69e/"><div>
            为什么小程序特立独行
            <!----></div></a> <span class="date">04-23</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/f761ed/"><div>
            单页应用与前端路由库设计原理
            <!----></div></a> <span class="date">04-23</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/596343/"><div>
            代码构建与 Webpack 必备技能
            <!----></div></a> <span class="date">04-23</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:localfeng@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/rwerplus" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=88954294" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2023
    <span>花椒和邻居 | <a href="https://github.com/rwerplus/rwerplus.github.io/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.0f535a60.js" defer></script><script src="/assets/js/2.05e52b40.js" defer></script><script src="/assets/js/32.1f1e2cf4.js" defer></script>
  </body>
</html>
